üß™ Execu√ß√£o local e Kubernetes (guia r√°pido)

Este guia cobre duas formas de rodar o backend: Docker Compose (local) e Minikube (Kubernetes). Se voc√™ s√≥ quer testar os endpoints rapidamente, use Docker Compose.

‚Äî

üêã Docker Compose (recomendado para local)

1) Subir servi√ßos na pasta `back/`:
```
docker compose up -d
```

2) Endpoints e portas expostas:
- Gateway REST: http://localhost:8080 (exp√µe /api/...)
- API direta (Spring Boot): http://localhost:8089/api
- Adminer (UI do banco): http://localhost:8081
  - servidor: db | usu√°rio: postgres | senha: postgres | database: dbspringboot

3) Teste r√°pido dos endpoints (exemplos):
```
curl http://localhost:8080/healthz
curl http://localhost:8080/api/usuario
curl http://localhost:8080/api/pergunta
```

Obs.: 8080 agora √© o gateway; o Adminer foi movido para 8081 para evitar conflito.

‚Äî

‚ò∏Ô∏è Minikube/Kubernetes

Antes de iniciar o cluster, instale o Minikube e o kubectl.

Exemplos (Linux):
```
curl -LO "https://storage.googleapis.com/kubernetes-release/release/$(curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt)/bin/linux/amd64/kubectl"
chmod +x kubectl && sudo mv kubectl /usr/local/bin/

curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64
sudo install minikube-linux-amd64 /usr/local/bin/minikube
```

Verifique:
```
minikube version
kubectl version --client
```

Inicie o cluster e aplique os manifests (na pasta `back/`):
```
minikube start --driver=docker
eval $(minikube docker-env)
chmod +x scripts/*.sh
bash scripts/build-images-rest.sh
kubectl apply -f k8s-rest/
kubectl get pods,svc
```

Acessando o gateway no Minikube:
- Op√ß√£o 1 (mais simples):
```
minikube service gateway-p-rest-service --url
```
- Op√ß√£o 2 (Ingress):
```
minikube addons enable ingress
MINIKUBE_IP=$(minikube ip)
echo "$MINIKUBE_IP rest.local" | sudo tee -a /etc/hosts
kubectl apply -f back/k8s-rest/ingress.yaml
# depois acesse: http://rest.local/
```

‚Äî

‚ùó Dicas de solu√ß√£o de problemas
- Se voc√™ tentar `http://localhost:8080/api/...` sem o gateway rodando, ver√° a tela do Adminer (porta 8080) ou erro 404. Com o Compose desta repo, o gateway atende em 8080 e o Adminer foi movido para 8081.
- A API direta continua acess√≠vel em `http://localhost:8089/api` (√∫til para testar sem gateway).
- Aguarde o Postgres ficar saud√°vel antes da API subir (o Compose j√° tem healthcheck para o banco).
